    def choose_action(self, obs):
        accel_final = 1.0
        steer_final = 0.0
        break_final = False

        if obs['items_type'] is not None:
            for i in range(len(obs['items_type'])):
                if obs['items_type'][i] == 1:  # banane = 1
                    banana_pos = obs['items_position'][i]  # les possitions des bananes

                    if 0 < banana_pos[2] < 9.5 and abs(banana_pos[0]) < 1.2: # 9.5 devant et 1.2 les deux côtés
                        #banane est a gauche ou a droite, on tourne dans le sens inverse pour l'éviter
                        if banana_pos[0] < 0:
                            steer_final = 0.9
                        else:
                            steer_final = -0.9

                        accel_final = 0.1   # On ralentit pour mieux tourner et éviter la banane
                        break_final = False
                        break

        if accel_final == 1.0:  # Si aucune banane proche, on suit la trajectoire
            target_x, target_z = self.position_track(obs)
            steer_final = self.compute_turning(target_x, target_z)
            accel_final, break_final, steer_final = self.manage_speed(obs, steer_final)

        return {
            "acceleration": accel_final,
            "steer": np.clip(steer_final, -1, 1),
            "brake": break_final,
            "drift": False,
            "nitro": True,
            "rescue": False,
            "fire": False
        }
